In [63]:

import pandas as pd
import json
import requests
import qgrid
import datetime as dt
qgrid.nbinstall(overwrite=True)

In [90]:

qgrid.set_defaults(remote_js=True, show_toolbar=True)

In [45]:

urls = list(range(1, 91))
urls.insert(0, 'index')

In [49]:

threads = []
for u in urls:
    try:
        r = requests.get('http://2ch.hk/dr/' + str(u) + '.json')
        j = json.loads(r.text)
        for thread in j['threads']:
            threads.append([thread['posts'][0]['num'], thread['posts'][0]['name'], thread['posts'][0]['subject'], 
                            thread['posts'][0]['trip'], 
                            thread['posts'][0]['timestamp'], thread['posts'][-1]['timestamp'], thread['posts_count']])
    except Exception:
        break

In [55]:

data = pd.DataFrame(threads, columns = ['num', 'name', 'subject', 'trip', 'open_date', 'last_date', 'posts'])

data['open'] = data['open_date'].apply(lambda x: pd.to_datetime(dt.datetime.fromtimestamp(x)))
data['last'] = data['last_date'].apply(lambda x: pd.to_datetime(dt.datetime.fromtimestamp(x)))

data = data.set_index('num')
data.index = data.index.astype(int)
data['count'] = 1
data = data.drop(['open_date', 'last_date', 'count'], axis = 1)
data['duration'] = (data['last'] - data['open']).dt.days
data = data.sort_values('open')

In [ ]:

 

In [91]:

qgrid.show_grid(data)

num
name
subject
trip
posts
open
last
duration
1
Аноним
3
2014-10-13
2017-04-01
901
2
Аноним
Все вы педерасты, один я молодец.
0
2014-10-13
2016-11-21
769
3
Аноним
Тред имени Павлика
3
2014-10-13
2015-02-09
119
5
Аноним
2
2014-10-13
2015-02-09
119
6
Аноним
87
2014-10-13
2014-12-14
61
12
Аноним
0
2014-10-14
2015-04-09
176
14
/
24
2014-10-14
2015-02-09
118
15
Аноним
0
2014-10-14
2015-02-09
118
18
Аноним
9
2014-10-14
2014-11-11
27
21
Аноним
0
2014-10-14
2015-02-09
118
48
Аноним
3
2014-10-14
2015-02-09
117
51
Михаилов Михаил Михайлович
Дневничок школьника-задрота
22
2014-10-14
2014-10-30
16
58
Тульпагруппик
10
2014-10-14
2016-01-31
473
65
Ника
Дневник Хоноки
!!tldVeFEPqY
209
2014-10-15
2016-04-24
556
141
Аноним
Начало новой жизни.
415
2014-10-15
2015-08-13
301
162
Аноним
Яства.
4
2014-10-16
2015-02-09
116
187
В трусах у пацана всё чаще пизда
Жизнь одного лодыря
!!cPmEWANnIo
36
2014-10-16
2014-12-03
47
194
Аноним
75
2014-10-16
2014-11-25
39
In [ ]:

 

In [ ]:

 

In [ ]:

 

In [ ]:

 

In [ ]:

 

In [ ]:

 

